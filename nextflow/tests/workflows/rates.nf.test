nextflow_pipeline {

    name "Test rates creation on b37"
    script "denovowest.nf"

    test("Should run without failures") {

        when {
            params {
                gff = "/nfs/users/nfs_e/ed11/lustre_ed11/DNW/DeNovoWEST/examples/rates/input/Homo_sapiens.GRCh37.87.DDX3X_SCN5A.gff3"
				genome_fasta = "/lustre/scratch123/hgi/mdt1/teams/hurles/ed11/resources/Homo_sapiens.GRCh37.dna.primary_assembly.fa"
				mutation_rate_model = "/lustre/scratch123/hgi/mdt1/teams/hurles/ed11/DNW/DeNovoWEST/resources/rates_model_dnn.tsv"
                outdir = "$outputDir"
				split_step = 100 // Split the gene list every split_step genes 
            }
        }

        then {
            assert workflow.success
            assert(path("$outputDir/rates/split/chunk_aa_mutation/mutation_rates.tsv").md5 == "81e80edfb9d66e6b4d00f646ea24f08a")
        }

    }

}